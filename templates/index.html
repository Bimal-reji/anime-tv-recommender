<!DOCTYPE html>
<html>
<head>
    <title>ðŸŽŒðŸ“º Anime & TV Show Recommender</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', sans-serif; background-color: #121212; color: white; padding: 40px; text-align: center; }
        h1 { color: #00e5ff; margin-bottom: 20px; }
        select, button { font-size: 1em; padding: 10px; border-radius: 6px; border: none; margin: 10px; }
        select { background-color: #333; color: white; }
        button { background-color: #03dac6; color: black; cursor: pointer; }
        #result { display: none; margin-top: 40px; }
        #result .container { display: flex; flex-direction: row; justify-content: center; align-items: flex-start; gap: 40px; flex-wrap: wrap; }
        .text-box { flex: 1; min-width: 300px; text-align: left; }
        .image-box img { max-width: 300px; border-radius: 10px; }
    </style>
</head>
<body>
    <h1>ðŸŽŒðŸ“º Anime & TV Show Recommender</h1>
    <label>Select category:</label>
    <select id="type" onchange="loadGenres()">
        <option value="anime">Anime</option>
        <option value="tv">TV Show</option>
    </select>

    <label>Select genre:</label>
    <select id="genre"></select>
    <button onclick="recommend()">ðŸŽ² Recommend</button>

    <div id="result">
        <div class="container">
            <div class="text-box">
                <h2 id="title"></h2>
                <p id="synopsis"></p>
            </div>
            <div class="image-box">
                <img id="poster" src="" />
            </div>
        </div>
    </div>

    <script>
        const genres = {
            anime: {{ anime_genres|tojson }},
            tv: {{ tv_genres|tojson }}
        };

        function loadGenres() {
            const type = document.getElementById("type").value;
            const genreSelect = document.getElementById("genre");
            genreSelect.innerHTML = "";

            if (type === "anime") {
                for (let key in genres.anime) {
                    let opt = document.createElement("option");
                    opt.value = genres.anime[key];
                    opt.text = key;
                    genreSelect.add(opt);
                }
            } else {
                genres.tv.forEach(g => {
                    let opt = document.createElement("option");
                    opt.value = g;
                    opt.text = g;
                    genreSelect.add(opt);
                });
            }
        }

        function recommend() {
            const type = document.getElementById("type").value;
            const genre = document.getElementById("genre").value;
            fetch(`/recommend?type=${type}&genre=${genre}`)
                .then(r => r.json())
                .then(d => {
                    document.getElementById("title").innerText = d.title;
                    document.getElementById("synopsis").innerText = d.description;
                    const poster = document.getElementById("poster");
                    if (d.image) {
                        poster.src = d.image;
                        poster.style.display = 'block';
                    } else {
                        poster.style.display = 'none';
                    }
                    document.getElementById("result").style.display = 'block';
                });
        }

        window.onload = loadGenres;
    </script>
</body>
</html>
